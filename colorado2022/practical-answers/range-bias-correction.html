<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Range bias correction | Introductory exercises with bioRad</title>
  <meta name="description" content="5 Range bias correction | Introductory exercises with bioRad" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Range bias correction | Introductory exercises with bioRad" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Range bias correction | Introductory exercises with bioRad" />
  
  
  

<meta name="author" content="Adriaan M. Dokter" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vertical-profiles.html"/>
<link rel="next" href="processing-many-polar-volumes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>1</b> Getting started</a></li>
<li class="chapter" data-level="2" data-path="basic-visualization-of-radar-scans.html"><a href="basic-visualization-of-radar-scans.html"><i class="fa fa-check"></i><b>2</b> Basic visualization of radar scans</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basic-visualization-of-radar-scans.html"><a href="basic-visualization-of-radar-scans.html#the-structure-of-polar-volumes"><i class="fa fa-check"></i><b>2.1</b> The structure of polar volumes</a></li>
<li class="chapter" data-level="2.2" data-path="basic-visualization-of-radar-scans.html"><a href="basic-visualization-of-radar-scans.html#plotting-radar-scans"><i class="fa fa-check"></i><b>2.2</b> Plotting radar scans</a></li>
<li class="chapter" data-level="2.3" data-path="basic-visualization-of-radar-scans.html"><a href="basic-visualization-of-radar-scans.html#overlaying-radar-scans-on-maps"><i class="fa fa-check"></i><b>2.3</b> Overlaying radar scans on maps</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="screening-out-weather.html"><a href="screening-out-weather.html"><i class="fa fa-check"></i><b>3</b> Screening out weather</a>
<ul>
<li class="chapter" data-level="3.1" data-path="screening-out-weather.html"><a href="screening-out-weather.html#using-correlation-coefficient"><i class="fa fa-check"></i><b>3.1</b> using correlation coefficient</a></li>
<li class="chapter" data-level="3.2" data-path="screening-out-weather.html"><a href="screening-out-weather.html#using-depolarization-ratio"><i class="fa fa-check"></i><b>3.2</b> using depolarization ratio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="vertical-profiles.html"><a href="vertical-profiles.html"><i class="fa fa-check"></i><b>4</b> Vertical profiles</a>
<ul>
<li class="chapter" data-level="4.1" data-path="vertical-profiles.html"><a href="vertical-profiles.html#loading-processed-vertical-profiles"><i class="fa fa-check"></i><b>4.1</b> Loading processed vertical profiles</a></li>
<li class="chapter" data-level="4.2" data-path="vertical-profiles.html"><a href="vertical-profiles.html#inspecting-single-vertical-profiles"><i class="fa fa-check"></i><b>4.2</b> Inspecting single vertical profiles</a></li>
<li class="chapter" data-level="4.3" data-path="vertical-profiles.html"><a href="vertical-profiles.html#plotting-vertical-profile-time-series"><i class="fa fa-check"></i><b>4.3</b> Plotting vertical profile time series</a></li>
<li class="chapter" data-level="4.4" data-path="vertical-profiles.html"><a href="vertical-profiles.html#vertical-and-time-integration-of-profiles"><i class="fa fa-check"></i><b>4.4</b> Vertical and time integration of profiles</a></li>
<li class="chapter" data-level="4.5" data-path="vertical-profiles.html"><a href="vertical-profiles.html#inspecting-precipitation-signals-in-profiles"><i class="fa fa-check"></i><b>4.5</b> Inspecting precipitation signals in profiles</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="range-bias-correction.html"><a href="range-bias-correction.html"><i class="fa fa-check"></i><b>5</b> Range bias correction</a>
<ul>
<li class="chapter" data-level="5.1" data-path="range-bias-correction.html"><a href="range-bias-correction.html#processing-a-polar-volume-into-a-profile"><i class="fa fa-check"></i><b>5.1</b> Processing a polar volume into a profile</a></li>
<li class="chapter" data-level="5.2" data-path="range-bias-correction.html"><a href="range-bias-correction.html#range-bias-correction-and-vertical-integration-on-a-map"><i class="fa fa-check"></i><b>5.2</b> Range bias correction and vertical integration on a map</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processing-many-polar-volumes.html"><a href="processing-many-polar-volumes.html"><i class="fa fa-check"></i><b>6</b> Processing many polar volumes</a>
<ul>
<li class="chapter" data-level="6.1" data-path="processing-many-polar-volumes.html"><a href="processing-many-polar-volumes.html#accessing-radar-data"><i class="fa fa-check"></i><b>6.1</b> Accessing radar data</a></li>
<li class="chapter" data-level="6.2" data-path="processing-many-polar-volumes.html"><a href="processing-many-polar-volumes.html#processing-multiple-polar-volumes"><i class="fa fa-check"></i><b>6.2</b> Processing multiple polar volumes</a></li>
<li class="chapter" data-level="6.3" data-path="processing-many-polar-volumes.html"><a href="processing-many-polar-volumes.html#parallel-processing"><i class="fa fa-check"></i><b>6.3</b> Parallel processing</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="further-analysis-outside-biorad.html"><a href="further-analysis-outside-biorad.html"><i class="fa fa-check"></i><b>7</b> Further analysis outside bioRad</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introductory exercises with bioRad</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="range-bias-correction" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Range bias correction<a href="range-bias-correction.html#range-bias-correction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this paragraph you will create an image of vertically integrated bird density that has been corrected for range biases. We will assume that all birds within the image are distributed vertically according to the same relative vertical profile.</p>
<p>We will start with downloading a polar volume and processing it into a profile:</p>
<div id="processing-a-polar-volume-into-a-profile" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Processing a polar volume into a profile<a href="range-bias-correction.html#processing-a-polar-volume-into-a-profile" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="range-bias-correction.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># download a polar volume for the KBRO radar in Brownsville, TX</span></span>
<span id="cb98-2"><a href="range-bias-correction.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download_pvolfiles</span>(<span class="at">date_min=</span><span class="fu">as.POSIXct</span>(<span class="st">&quot;2017-05-14 05:50:00&quot;</span>), <span class="at">date_max=</span><span class="fu">as.POSIXct</span>(<span class="st">&quot;2017-05-14 06:00:00&quot;</span>), <span class="at">radar=</span><span class="st">&quot;KBRO&quot;</span>, <span class="at">directory=</span><span class="st">&quot;./data_pvol&quot;</span>)</span></code></pre></div>
<pre><code>## Downloading data from noaa-nexrad-level2 for radar KBRO spanning over 1 days</code></pre>
<pre><code>## 
## Downloading pvol for 2017/05/14/KBRO/</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="range-bias-correction.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all the polar volume filenames downloaded so far for the KBRO radar:</span></span>
<span id="cb101-2"><a href="range-bias-correction.html#cb101-2" aria-hidden="true" tabindex="-1"></a>my_pvolfiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="st">&quot;./data_pvol&quot;</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern=</span><span class="st">&quot;KBRO&quot;</span>)</span>
<span id="cb101-3"><a href="range-bias-correction.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we will process the first one into a vp:</span></span>
<span id="cb101-4"><a href="range-bias-correction.html#cb101-4" aria-hidden="true" tabindex="-1"></a>my_pvolfile <span class="ot">&lt;-</span> my_pvolfiles[<span class="dv">1</span>]</span>
<span id="cb101-5"><a href="range-bias-correction.html#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the profile, using MistNet to remove precipitation:</span></span>
<span id="cb101-6"><a href="range-bias-correction.html#cb101-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we calculate 60 layers of 50 meter width, so up to 30*100=3000 m.</span></span>
<span id="cb101-7"><a href="range-bias-correction.html#cb101-7" aria-hidden="true" tabindex="-1"></a>my_vp <span class="ot">&lt;-</span> <span class="fu">calculate_vp</span>(my_pvolfile, <span class="at">n_layer=</span><span class="dv">60</span>, <span class="at">h_layer=</span><span class="dv">50</span>, <span class="at">sd_vvp_threshold =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="range-bias-correction-and-vertical-integration-on-a-map" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Range bias correction and vertical integration on a map<a href="range-bias-correction.html#range-bias-correction-and-vertical-integration-on-a-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="range-bias-correction.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We will use the piping operator %&gt;% of magrittr package to</span></span>
<span id="cb102-2"><a href="range-bias-correction.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># execute multiple operations in one statement:</span></span>
<span id="cb102-3"><a href="range-bias-correction.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb102-4"><a href="range-bias-correction.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># first, load the polar volume:</span></span>
<span id="cb102-5"><a href="range-bias-correction.html#cb102-5" aria-hidden="true" tabindex="-1"></a>my_pvolfile <span class="sc">%&gt;%</span> <span class="fu">read_pvolfile</span>() <span class="ot">-&gt;</span> my_pvol</span></code></pre></div>
<pre><code>## Filename = ./data_pvol/2017/05/14/KBRO/KBRO20170514_055309_V06, callid = KBRO
## Reading RSL polar volume with nominal time 20170514-055309, source: RAD:KBRO,PLC:BROWNSVILLE,state:TX,radar_name:KBRO</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="range-bias-correction.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, let&#39;s calculate a PPI for the 1.5 degree elevation scan</span></span>
<span id="cb104-2"><a href="range-bias-correction.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Finally, we calculated the vertically integrated PPI</span></span>
<span id="cb104-3"><a href="range-bias-correction.html#cb104-3" aria-hidden="true" tabindex="-1"></a>my_ppi_integrated <span class="ot">&lt;-</span> <span class="fu">integrate_to_ppi</span>(<span class="at">pvol=</span>my_pvol,<span class="at">vp=</span>my_vp, <span class="at">res=</span><span class="dv">1000</span>)</span></code></pre></div>
<p><strong>Exercise 13:</strong> Visually compare the PPI for the 1.0 degree sweep and the vertically integrated PPI, and explain the differences. Hint: for the clearest comparison, make plots of comparable parameters that are either linear or logarithmic in bird density.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="range-bias-correction.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-2"><a href="range-bias-correction.html#cb105-2" aria-hidden="true" tabindex="-1"></a>my_pvol <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="range-bias-correction.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_scan</span>(<span class="at">elev =</span> <span class="fl">1.0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="range-bias-correction.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">project_as_ppi</span>(<span class="at">raster=</span>raster<span class="sc">::</span><span class="fu">raster</span>(my_ppi_integrated<span class="sc">$</span>data)) <span class="ot">-&gt;</span></span>
<span id="cb105-5"><a href="range-bias-correction.html#cb105-5" aria-hidden="true" tabindex="-1"></a>  my_ppi</span>
<span id="cb105-6"><a href="range-bias-correction.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s take the logarithm of the vertically integrated density, so</span></span>
<span id="cb105-7"><a href="range-bias-correction.html#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># we can compare it more directly to DBZH, which is also a logarithmic quantity:</span></span>
<span id="cb105-8"><a href="range-bias-correction.html#cb105-8" aria-hidden="true" tabindex="-1"></a>my_ppi_integrated <span class="ot">&lt;-</span> <span class="fu">calculate_param</span>(my_ppi_integrated, <span class="at">logVID=</span><span class="fu">log</span>(VID))</span>
<span id="cb105-9"><a href="range-bias-correction.html#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plot both ppi&#39;s:</span></span>
<span id="cb105-10"><a href="range-bias-correction.html#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(my_ppi)</span></code></pre></div>
<p><img src="rad_aero_22_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="range-bias-correction.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(my_ppi_integrated, <span class="at">param=</span><span class="st">&quot;logVID&quot;</span>, <span class="at">zlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>))</span></code></pre></div>
<p><img src="rad_aero_22_files/figure-html/unnamed-chunk-41-2.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="range-bias-correction.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The altitude distribution in this case shows two migration layers.</span></span>
<span id="cb107-2"><a href="range-bias-correction.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In the 1.5 PPI scan these show up as two concentric rings of density.</span></span>
<span id="cb107-3"><a href="range-bias-correction.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Since in a conventional PPI a larger distance from the radar also</span></span>
<span id="cb107-4"><a href="range-bias-correction.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="co"># implies a higher altitude, we see the rings showing up at the</span></span>
<span id="cb107-5"><a href="range-bias-correction.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ranges where the beam intersects each of the migration layers.</span></span>
<span id="cb107-6"><a href="range-bias-correction.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb107-7"><a href="range-bias-correction.html#cb107-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The vertically integrated PPI is more straightforward to interpret</span></span>
<span id="cb107-8"><a href="range-bias-correction.html#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we correct for aforementioned beam effects and integrate the</span></span>
<span id="cb107-9"><a href="range-bias-correction.html#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="co"># density over altitude, giving a more realistic reconstruction of the</span></span>
<span id="cb107-10"><a href="range-bias-correction.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co"># spatial distribution of migrants.</span></span></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="vertical-profiles.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="processing-many-polar-volumes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
