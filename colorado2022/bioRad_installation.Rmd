---
title: "Install instructions for bioRad"
output: html_notebook
---
During the Aeroecology course we will be using the R-package **[bioRad]( https://adokter.github.io/bioRad)**, a collection of tools to analyze and visualize biological signals in weather radar data. During the course you will get a sneak preview of the very latest version of bioRad (0.7.0), which hasn't been published on CRAN yet.

**Please take time to install the software before your travel to Colorado**

We strongly recommend upgrading to a recent version of R (latest version is 4.2.1, found at https://www.r-project.org/). We also recommend installing [Rstudio](https://www.rstudio.com/products/rstudio/) as a graphical user interface.

Please follow below install instructions to install the bioRad package (Note there are different instructions for Windows and for Mac OSX / Linux).

## Installation on Windows systems

### Step 1: install vol2birdR.
First, we install the **[vol2birdR](https://adriaandokter.com/vol2birdR/)** package (a dependency package for bioRad). This package will be on CRAN soon, but we will install a pre-compiled binary for now:
```{r, eval=FALSE}
install.packages(c("Rcpp", "assertthat", "pkgbuild", "rlang"))
install.packages("https://s3.amazonaws.com/mistnet/windows/vol2birdR_0.1.1.9913.zip",repos=NULL)
```

### Step 2: download mistnet libraries
Next, we install several deep-learning and helper libraries to enable Mistnet"
```{r, eval=FALSE}
vol2birdR::install_mistnet()
```

### Step 3: download mistnet model
Next, we download the mistnet model into `vol2birdR`:
```{r, eval=FALSE}
vol2birdR::install_mistnet_model()
```

### Step 4: install bioRad
Finally, we can install bioRad:
```{r, eval=FALSE}
# Step 4a: enable both the CRAN and bioconductor repositories:
setRepositories(ind=1:2)
# Step 4b: install latest release of bioRad:
install.packages("bioRad")
# Step 4c: upgrade bioRad to the latest development version:
install.packages("https://s3.amazonaws.com/mistnet/windows/bioRad_0.7.0.9522.zip", repos=NULL)
```

You should now be able to load bioRad. The welcome message should mention version 0.7.0.9522, and MistNet installed.
```{r, eval=FALSE}
# load bioRad:
library(bioRad)

# expected message:
#> Welcome to bioRad version 0.7.0.9522
#> using vol2birdR version 0.1.1.9913 (MistNet installed)
```

## Installation on Mac OSX and Linux systems:

### Step 1: install system libraries:
We first need to install several system libraries that are used by **[vol2birdR](https://adriaandokter.com/vol2birdR/)** package, which will be installed as part of bioRad. 

#### Step 1 for Mac OSX:
First install [Homebrew](https://brew.sh/), a package manager for Mac OSX. It helps you installing missing libraries. After installing [Homebrew](https://brew.sh/), open a terminal (you can find it by searching for `terminal`) and type:

```
brew install hdf5 proj gsl
```

#### Step 1 for Linux:
On Debian-based systems (including Ubuntu), run:
```
# libraries required for vol2birdR:
sudo apt-get install libhdf5-dev libproj-dev gsl-bin libgsl-dev
# libraries required for other dependency packages:
sudo apt-get install libcurl4-openssl-dev libssl-dev libgdal-dev
```

On other Linux systems supporting yum and RPMs, run:
```
sudo yum install hdf5-devel proj-devel gsl gsl-devel
```
### Step 2: pre-install some packages:
Next, open R using Rstudio. As of July 2022, a few packages require manual installation (for reasons unrelated to bioRad). In the console window execute the following:
```{r, eval=FALSE}
# Step 2a: install package devtools (if you don't have it already)
install.packages("devtools")
# Step 2b: (Mac OSX only): install rgdal and terra
install.packages(c("rgdal","terra"), type="binary")
# Step 2c: upgrade ggmap to latest development version:
devtools::install_github("dkahle/ggmap")
```

### Step 3: install bioRad
You can now open R using Rstudio and install bioRad as follows:
```{r, eval=FALSE}
# Step 3a: enable both the CRAN and bioconductor repositories:
setRepositories(ind=1:2)
# Step 3b: install the latest development release of bioRad:
devtools::install_github("adokter/bioRad")
```

### Step 4: download mistnet libraries
The bioRad installation of the previous step should have automatically installed the **[vol2birdR](https://adriaandokter.com/vol2birdR/)** package as well, which is an important dependency package for bioRad. Next, we need to run a few vol2birdR commands to enable Mistnet (expect a ~ 150 Mb download)
```{r, eval=FALSE}
vol2birdR::install_mistnet()
```

### Step 5: download mistnet model
Next, we download the mistnet model into vol2birdR (expect >500 Mb download, this step can take a while when you have a slow internet connection)
```{r, eval=FALSE}
vol2birdR::install_mistnet_model()
```

### Step 6: load bioRad
You should now be able to load bioRad. The welcome message should mention version 0.7.0.9522, and MistNet installed.
```{r, eval=FALSE}
# load bioRad:
library(bioRad)

# expected message:
#> Welcome to bioRad version 0.7.0.9522
#> using vol2birdR version 0.1.1.9913 (MistNet installed)
```
